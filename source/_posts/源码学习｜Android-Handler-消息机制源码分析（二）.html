<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æºç å­¦ä¹ ï½œAndroid Handler æ¶ˆæ¯æœºåˆ¶æºç åˆ†æï¼ˆäºŒï¼‰</title>
    <style type="text/css" media="all">
      body {
        margin: 0;
        font-family: "Helvetica Neue", Helvetica, Arial, "Hiragino Sans GB", sans-serif;
        font-size: 14px;
        line-height: 20px;
        color: #777;
        background-color: white;
      }
      .container {
        width: 700px;
        margin-right: auto;
        margin-left: auto;
      }

      .post {
        font-family: Georgia, "Times New Roman", Times, "SimSun", serif;
        position: relative;
        padding: 70px;
        bottom: 0;
        overflow-y: auto;
        font-size: 16px;
        font-weight: normal;
        line-height: 25px;
        color: #515151;
      }

      .post h1{
        font-size: 50px;
        font-weight: 500;
        line-height: 60px;
        margin-bottom: 40px;
        color: inherit;
      }

      .post p {
        margin: 0 0 35px 0;
      }

      .post img {
        border: 1px solid #D9D9D9;
      }

      .post a {
        color: #28A1C5;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="post">
        <h1 class="title">æºç å­¦ä¹ ï½œAndroid Handler æ¶ˆæ¯æœºåˆ¶æºç åˆ†æï¼ˆäºŒï¼‰</h1>
        <div class="show-content">
          <p>åœ¨ä¸Šæ¬¡æˆ‘ä»¬åˆ†æåˆ°Handleråœ¨åˆ›å»ºæ—¶ä¼šç»‘å®šä¸€ä¸ªLooperå¯¹è±¡ï¼Œè€Œå¦‚æœLooperç”¨æˆ·ä¸è¿›è¡Œæ˜¾å¼ä¼ å…¥ï¼Œä¼šåœ¨Handlerä¸­è°ƒç”¨Looper.myLooper()æ¥åˆ›å»ºä¸€ä¸ªLooperå¯¹è±¡ã€‚&nbsp;</p><p>é‚£ä»€ä¹ˆæ˜¯Looperå‘¢ï¼ŸAndroidä¸­å¯¹äºLooperç±»çš„æ³¨é‡Šä¸­æ˜¯è¿™æ ·æè¿°çš„ï¼šâ€œClass used to run a message loop for a threadâ€ã€‚å¤§æ¦‚æ„æ€æ˜¯æŒ‡è¿™ä¸ªç±»æ˜¯ç”¨æ¥ä¸ºä¸€ä¸ªçº¿ç¨‹åšæ¶ˆæ¯å¾ªç¯ã€‚è€ŒLooper ç±»æœ¬èº«è¢«å£°æ˜ä¸ºfinalç±»å‹çš„ï¼ŒåŒæ—¶å®ƒçš„æ„é€ æ–¹æ³•ä¹Ÿè¢«å£°æ˜ä¸ºfinalç±»å‹ã€‚æ‰€ä»¥æˆ‘ä»¬å¦‚æœè¦è·å–å…¶ä¸­çš„Looperå®ä¾‹æˆ–è€…ä½¿ç”¨Looperçš„æ–¹æ³•éœ€è¦ä½¿ç”¨å…¶ä¸­æä¾›çš„ä¸¤ç§é™æ€æ–¹æ³•ï¼š</p><div class="image-package"><img src="http://upload-images.jianshu.io/upload_images/1489253-6a6158c9a3c87f21.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" data-original-src="http://upload-images.jianshu.io/upload_images/1489253-6a6158c9a3c87f21.png?imageMogr2/auto-orient/strip" data-image-slug="6a6158c9a3c87f21" data-width="1556" data-height="282"><br><div class="image-caption"></div></div><div class="image-package"><img src="http://upload-images.jianshu.io/upload_images/1489253-7cbaeb63aea6c3e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" data-original-src="http://upload-images.jianshu.io/upload_images/1489253-7cbaeb63aea6c3e5.png?imageMogr2/auto-orient/strip" data-image-slug="7cbaeb63aea6c3e5" data-width="1310" data-height="218"><br><div class="image-caption"></div></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæ˜¯getMainLooper()æ–¹æ³•è¿˜æ˜¯myLooper()æ–¹æ³•ï¼Œè·å–çš„Looperéƒ½æ˜¯ç›´æ¥è¿”å›å·²ç»åˆå§‹åŒ–çš„å¯¹è±¡ã€‚é‚£å®ƒä»¬çš„åˆå§‹åŒ–åœ¨å“ªæ“ä½œçš„å‘¢ï¼Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><div class="image-package"><img src="http://upload-images.jianshu.io/upload_images/1489253-15a623d946d67366.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" data-original-src="http://upload-images.jianshu.io/upload_images/1489253-15a623d946d67366.png?imageMogr2/auto-orient/strip" data-image-slug="15a623d946d67366" data-width="1530" data-height="1038"><br><div class="image-caption"></div></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸»çº¿ç¨‹Looperå’Œå­çº¿ç¨‹Looperåˆ›å»ºçš„åŒºåˆ«åœ¨äºä¸€ä¸ªquitAllowedå˜é‡ï¼ˆä¸»çº¿ç¨‹ä¸ºfalse, å­çº¿ç¨‹ä¸ºtrueï¼‰ã€‚è€Œæœ€ç»ˆè¿™ä¸ªå˜é‡ä¼šä¼ å…¥åˆ°Looperæ„é€ æ–¹æ³•ä¸­ç”¨äºæ„é€ MessageQueueã€‚è€ŒLooperä¸­çš„çº¿ç¨‹ç»‘å®šçš„æ˜¯å½“å‰çº¿ç¨‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><br></p><div class="image-package"><img src="http://upload-images.jianshu.io/upload_images/1489253-8846ed6a2eeca544.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" data-original-src="http://upload-images.jianshu.io/upload_images/1489253-8846ed6a2eeca544.png?imageMogr2/auto-orient/strip" data-image-slug="8846ed6a2eeca544" data-width="930" data-height="174"><br><div class="image-caption"></div></div><p>è¿™æ ·çš„è¯ï¼Œç»“åˆä¸Šä¸€ç¯‡ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç›´æ¥åœ¨å­çº¿ç¨‹ä¸­ä½¿ç”¨Handler handler = new Handler(),ä¼šè°ƒç”¨Looper.myLooper()æ–¹æ³•è·å–Looperå¯¹è±¡ï¼Œåœ¨è¿™ä¹‹å‰å¹¶æ²¡æœ‰è°ƒç”¨Looper.prepare()æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œæ‰€ä»¥sThreadLocal.get()ä¸­ä¼šè¿”å›nullï¼Œè¿›è€ŒæŠ¥é”™ã€‚</p><p>é‚£å¤§å®¶æˆ–è®¸ä¼šé—®ï¼Œä¸»çº¿ç¨‹ä¸­çš„mainLooperæ˜¯ä½•æ—¶è¿›è¡Œåˆå§‹åŒ–çš„å‘¢ï¼Œä¸ºä»€ä¹ˆä¸»çº¿ç¨‹ä¸­ç›´æ¥new Handler()ä¸ä¼šæŠ¥é”™å‘¢ï¼Ÿå…¶å®è¿™ä¸ªä¸»çº¿ç¨‹Handleråœ¨åº”ç”¨å¯åŠ¨æ—¶å°±å·²ç»è¿›è¡Œäº†åˆå§‹åŒ–ï¼Œå…·ä½“å¯åŠ¨æ—¶æœºéœ€è¦åœ¨åé¢ç»§ç»­åˆ†æå‘¢ï½ğŸ˜Š</p><p>psï¼šæ›´æ–°ç›¸å…³çš„ä¸¤ç¯‡æ–‡ç« ä¼ é€é—¨ï¼š</p><p><a target="_blank" href="http://www.jianshu.com/p/2b055625b400">ã€ŠAndroid Handleræ¶ˆæ¯æœºåˆ¶æºç åˆ†æï¼ˆä¸€ï¼‰ã€‹</a>&nbsp;<br></p><p><a href="http://www.jianshu.com/p/04c76187de3a" target="_blank">ã€ŠAndroid Handleræ¶ˆæ¯æœºåˆ¶æºç åˆ†æï¼ˆä¸‰ï¼‰ã€‹</a><br></p>
        </div>
      </div>
    </div>
  </body>
</html>
